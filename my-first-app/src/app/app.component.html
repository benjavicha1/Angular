<div class="mat-background">
  <div class="stepper-container">
    <mat-vertical-stepper linear #surveyStepper>
      <!-- Step 1 -->
      <mat-step [stepControl]="formGroup1">
        <!-- Form Group -->
        <form [formGroup]="formGroup1">
          <!-- Step Label -->
          <ng-template matStepLabel>
            <b>Survey Type:</b>
            <mat-chip-list *ngIf="selectedSurveyType_Name">
              <mat-chip (click)="surveyStepper.selectedIndex = 0" matChipRemove>
                {{ selectedSurveyType_Name }}
                <mat-icon matChipRemove (click)="onCancelClickSurveyTypeChip()">
                  cancel
                </mat-icon>
              </mat-chip>
            </mat-chip-list>
          </ng-template>
          <mat-form-field appearance="outline">
            <mat-label>Select a type</mat-label>
            <mat-select
              formControlName="surveyTypeControl"
              required
              [(ngModel)]="selectedSurveyType"
              (selectionChange)="changeClientSurveyType($event.value)"
            >
              <mat-option selected>None</mat-option>
              <mat-option
                *ngFor="let type of surveyTypes; let i = index"
                [value]="i"
              >
                {{ type.name }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="surveyTypeControl.hasError('required')">
              Please choose a type of survey
            </mat-error>
          </mat-form-field>
          <mat-card
            class="survey-type-card"
            *ngIf="selectedSurveyType_DescriptionList"
          >
            <mat-list>
              <li
                mat-list-item
                *ngFor="let description of selectedSurveyType_DescriptionList"
              >
                {{ description }}
              </li>
            </mat-list>
          </mat-card>
          <div *ngIf="selectedSurveyType_Name">
            <br />
            <button mat-raised-button matStepperNext>Next</button>
          </div>
        </form>
      </mat-step>

      <!-- Step 2 -->
      <mat-step
        [stepControl]="formGroup2"
        [optional]="true"
        *ngIf="allowedConfigTypeList.includes(selectedSurveyType_Id)"
      >
        <form [formGroup]="formGroup2">
          <!-- Step Label -->
          <ng-template matStepLabel><b>Configuration</b></ng-template>
          <mat-form-field appearance="outline">
            <mat-label>Configuration(s)</mat-label>
            <mat-select [formControl]="Configurations" multiple>
              <mat-select-trigger>
                {{ Configurations.value ? Configurations.value[0] : "" }}
                <span
                  *ngIf="Configurations.value?.length > 1"
                  class="example-additional-selection"
                >
                  (+{{ Configurations.value.length - 1 }}
                  {{ Configurations.value?.length === 2 ? "other" : "others" }})
                </span>
              </mat-select-trigger>
              <mat-option
                *ngFor="let configuration of configurationList"
                [value]="configuration"
                >{{ configuration }}</mat-option
              >
            </mat-select>
          </mat-form-field>
          <p>
            <b>*Note:</b> By default, participants will have access to surveys
            on the next day of enrollment day and for entire project length
            period.
          </p>
          <div>
            <br />
            <button mat-raised-button matStepperPrevious>Back</button>
            &nbsp;
            <button mat-raised-button matStepperNext>Next</button>
          </div>
        </form>
      </mat-step>

      <!-- Step 3: Done -->
      <mat-step *ngIf="showDone">
        <ng-template matStepLabel>Done</ng-template>
        <p>You are now done.</p>
        <div>
          <button mat-raised-button matStepperPrevious>Back</button>
          &nbsp;
          <button
            mat-raised-button
            color="warn"
            (click)="changeClientSurveyType(null); surveyStepper.reset()"
          >
            Reset
          </button>
        </div>
      </mat-step>
    </mat-vertical-stepper>
  </div>
</div>
